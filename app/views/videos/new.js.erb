<%- session_key_name = ActionController::Base.session_options[:key] -%>
<%- 
uploadify_extensions = []
for ext in @video.extensions
	uploadify_extensions.push("*." + ext)
end
-%>
$(document).ready(function($) {
  $('#video_submit').click(function(){
    $('#video_file').uploadifyUpload();
    return false;
  });

  $('#video_file').uploadify({
    "cancelImg" : "/uploadify/cancel.png",
    "buttonText" : "Browse",
    "scriptData" : {
      "<%= session_key_name %>" : "<%= u(cookies[session_key_name]) %>",
      "authenticity_token" : "<%= u(form_authenticity_token) %>"
    },
    "multi" : true,
    "script" : "<%= videos_path %>",
    "uploader" : "/uploadify/uploadify.swf",
    "fileDesc" : "Please select a video file. Valid formats are: " + "<%= @video.extensions.join(", ")%>",
	"fileExt" : "<%= uploadify_extensions.join(";") %>",
	'onComplete': function(event, queueID, fileObj, response, data) {
	   fileName_location = "#video_file" + queueID + " .fileName";
	   percentage_location = "#video_file" + queueID + " .percentage";
       $(fileName_location).html(fileObj.name + " - " + response);
	   $(percentage_location).empty();
       return false;
	}
  });
})